version: '3.8'

services:
  # Your .NET WebAPI Service
  api:
    build: .
    container_name: smarthydro_api
    ports:
      - "8080:8080"
    environment:
      # This connection string overrides the one in appsettings.json
      - ConnectionStrings__DefaultConnection=Server=mysql;Database=smartHydro;User=smarthydro_api;Password=SmartHydro2025!;
      # This tells your API to find the MQTT broker by its service name
      - MQTT_BROKER=mosquitto
    depends_on:
      - mysql
      - mosquitto
